# Business logic

Voici un tableau synthétique des principaux scénarios de **failles de logique métier (business logic)**, avec pour chaque cas des exemples complets et différenciés pour les commandes d’attaque et d’analyse, en texte brut, sans indentation ni numérotation, et avec une méthodologie détaillée et une URL PortSwigger complète.

| Type / Lab | Payload d’attaque neutre (exemple brut) | Commande d’attaque (exemple complet) | Commande d’analyse (exemple complet) | Élément d’analyse détaillé | Méthodologie détaillée de découverte | Source |
|---|---|---|---|---|---|---|
| Contournement de validation panier ou prix | Modifier le prix ou la quantité d’un produit dans une requête, par exemple changer price=10 en price=1 ou quantity=1 en quantity=100 lors d’un ajout au panier, sur https://site-victime.net/cart/update | curl -X POST -d "product_id=123&price=1&quantity=100" https://site-victime.net/cart/update | curl -b "session=client1" https://site-victime.net/cart puis curl -b "session=client1" https://site-victime.net/checkout pour vérifier si la commande à prix réduit ou quantité excessive est acceptée | Vérifier si le serveur accepte et applique la modification du prix ou de la quantité, permettant d’acheter à prix réduit ou d’obtenir plus de produits que prévu, sans recalcul ni contrôle côté serveur | Intercepter une requête de panier, modifier les valeurs de prix ou de quantité, valider la commande puis observer si la modification est prise en compte lors du calcul final ou à la validation du paiement | https://portswigger.net/web-security/logic-flaws/examples/price-manipulation |
| Contournement de workflow ou contrôle d’étapes | Accéder à une étape finale sans avoir complété les étapes intermédiaires, par exemple accéder directement à https://site-victime.net/checkout/confirm sans avoir validé le paiement | curl -b "session=client2" https://site-victime.net/checkout/confirm | curl -b "session=client2" https://site-victime.net/orders puis curl -b "session=client2" https://site-victime.net/account pour vérifier si la commande a été enregistrée sans paiement | Vérifier si l’application permet de sauter des étapes critiques du workflow, permettant d’obtenir un produit ou un service sans respecter les conditions prévues | Cartographier le flux métier, tenter d’accéder directement à une étape ultérieure, observer si le serveur applique les contrôles de séquence et si l’action interdite est acceptée ou non | https://portswigger.net/web-security/logic-flaws/examples/workflow-bypass |
| Utilisation abusive de coupons ou codes promo | Appliquer plusieurs fois le même code promo ou différentes combinaisons pour obtenir une réduction excessive, par exemple envoyer plusieurs fois coupon=REDUC50 sur https://site-victime.net/cart/apply-coupon | curl -X POST -d "coupon=REDUC50" https://site-victime.net/cart/apply-coupon puis répéter la commande deux ou trois fois | curl -b "session=client3" https://site-victime.net/cart puis curl -b "session=client3" https://site-victime.net/checkout pour vérifier si la réduction est cumulée ou appliquée plusieurs fois | Vérifier si le serveur permet l’utilisation répétée ou combinée de codes promotionnels, entraînant une réduction supérieure à ce qui est prévu par la logique métier | Appliquer plusieurs fois le même code promo ou différentes combinaisons, observer l’évolution du montant total du panier, puis vérifier si la réduction cumulée dépasse la limite prévue | https://portswigger.net/web-security/logic-flaws/examples/coupon-abuse |
| Contournement de limites d’usage ou quotas | Dépasser une limite d’utilisation prévue, par exemple soumettre plusieurs fois un formulaire censé être limité à une seule soumission par utilisateur, sur https://site-victime.net/feedback | curl -X POST -d "message=Test1" https://site-victime.net/feedback puis répéter la commande plusieurs fois | curl -b "session=client4" https://site-victime.net/feedbacks puis curl -b "session=client4" https://site-victime.net/account pour vérifier si plusieurs soumissions ont été acceptées | Vérifier si le serveur applique correctement les quotas ou limites d’usage, ou si un utilisateur peut contourner ces restrictions par des requêtes répétées | Identifier une fonctionnalité soumise à quota, effectuer des soumissions répétées, puis vérifier si le serveur bloque ou accepte les requêtes au-delà de la limite prévue, en consultant l’historique ou les notifications | https://portswigger.net/web-security/logic-flaws/examples/rate-limiting |
| Manipulation de paramètres pour avantage | Modifier un paramètre caché ou non documenté dans une requête, par exemple changer user_role=user en user_role=admin dans une requête POST vers https://site-victime.net/profile/update | curl -X POST -d "user_role=admin" https://site-victime.net/profile/update -b "session=client5" | curl -b "session=client5" https://site-victime.net/profile puis curl -b "session=client5" https://site-victime.net/admin pour vérifier si le changement de rôle ou de privilège est pris en compte | Vérifier si le serveur applique des contrôles pour empêcher la modification non autorisée de paramètres sensibles, comme un changement de rôle ou de privilège | Identifier un paramètre sensible dans une requête, tenter sa modification, puis observer si le serveur applique la modification sans vérification d’autorisation, en testant l’accès à des ressources réservées | https://portswigger.net/web-security/logic-flaws/examples/parameter-manipulation |

---

