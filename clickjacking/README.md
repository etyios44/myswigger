# Clickjacking

Voici un tableau pour l’analyse des failles clickjacking sur les labs PortSwigger, avec des **exemples de commandes curl plus complets** (utilisation de -I, -v, -A, --referer, --cookie, etc.) et des phrases correctes en français. Les charges utiles sont neutres pour garantir l’alignement parfait des colonnes.

| Type / Lab                             | Payload d’attaque neutre    | Commande d’attaque (curl)                                                                                          | Commande(s) d’analyse curl                                                                                       | Élément d’analyse (raison préalable)                                    | Méthodologie détaillée de découverte                                                                                   | URL                                                                                   |
|-----------------------------------------|-----------------------------|--------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|
| Clickjacking basique                   | testclickjacking            | curl -A "Mozilla/5.0" -L "https://LAB/my-account"                                                                  | curl -I -v "https://LAB/my-account"                                                                              | Absence d’en-tête de protection (X-Frame-Options, CSP frame-ancestors)   | Envoyez une requête GET sur la page cible avec un user-agent courant. Utilisez -I et -v pour afficher tous les en-têtes. Vérifiez l’absence de X-Frame-Options ou CSP frame-ancestors. Si ces protections sont absentes, la page est vulnérable. | https://portswigger.net/web-security/clickjacking                                   |
| Clickjacking avec étape de confirmation | testmulticlick              | curl -A "Mozilla/5.0" -L "https://LAB/delete-account"                                                              | curl -I -v "https://LAB/delete-account" ; curl -I -v "https://LAB/confirm-delete"                                | Absence d’en-tête de protection sur plusieurs étapes                      | Testez chaque étape critique du processus (suppression puis confirmation). Utilisez -I -v pour vérifier les en-têtes à chaque étape. Si l’une des étapes n’est pas protégée, la faille existe. | https://portswigger.net/web-security/clickjacking/lab-multistep                     |
| Clickjacking avec pré-remplissage champ | testprefilled               | curl -A "Mozilla/5.0" -L "https://LAB/my-account?email=testprefilled"                                              | curl -I -v "https://LAB/my-account?email=testprefilled"                                                          | Absence d’en-tête de protection et champ pré-rempli                        | Envoyez une requête avec un paramètre pré-rempli. Contrôlez les en-têtes avec -I -v. Si la page accepte le pré-remplissage et n’a pas de protection, la faille est présente. | https://portswigger.net/web-security/clickjacking/lab-prefilled-form-input           |
| Clickjacking déclenchant une action     | testtriggerxss              | curl -A "Mozilla/5.0" -e "https://LAB/" -L "https://LAB/feedback?name=testtriggerxss"                              | curl -I -v "https://LAB/feedback?name=testtriggerxss"                                                            | Absence d’en-tête de protection et action déclenchée par clic              | Utilisez --referer pour simuler une navigation réelle. Vérifiez les en-têtes avec -I -v. Si la page n’est pas protégée et qu’un clic déclenche une action, la faille est exploitable. | https://portswigger.net/web-security/clickjacking/lab-exploiting-to-trigger-dom-based-xss |
| Clickjacking avec protection CSRF       | testcsrfclick               | curl -A "Mozilla/5.0" --cookie "session=valeur" -L "https://LAB/my-account"                                        | curl -I -v --cookie "session=valeur" "https://LAB/my-account"                                                    | Présence d’un jeton CSRF mais absence de protection frame                  | Accédez à la page avec un cookie de session valide. Vérifiez les en-têtes avec -I -v. Si la page est accessible en iframe malgré la présence d’un jeton CSRF, la protection clickjacking est insuffisante. | https://portswigger.net/web-security/clickjacking/lab-basic-csrf-protected           |

---

