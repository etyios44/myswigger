# CORS

Voici un tableau synthétique pour l’analyse et la découverte des failles CORS sur les labs PortSwigger, avec **des commandes curl différenciées et complètes** pour chaque cas, des charges utiles neutres, et des explications claires en français :

| Type / Lab                                 | Payload d’attaque neutre         | Commande d’attaque (curl)                                                                                                   | Commande(s) d’analyse curl                                                                                                 | Élément d’analyse (raison préalable)                                 | Méthodologie détaillée de découverte                                                                                   | URL                                                                                   |
|---------------------------------------------|----------------------------------|-----------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|
| CORS permissif (réflexion basique)          | origine tierce                   | curl -H "Origin: http://attacker.com" "https://LAB/accountDetails"                                                          | curl -H "Origin: http://attacker.com" -i "https://LAB/accountDetails"                                                      | Access-Control-Allow-Origin reflète l’origine tierce                | Envoyez une requête GET avec un en-tête Origin différent du domaine cible. Vérifiez si Access-Control-Allow-Origin reprend l’origine tierce envoyée. | https://portswigger.net/web-security/cors/lab-basic-origin-reflection                 |
| CORS permissif avec credentials             | origine tierce + cookie          | curl -H "Origin: http://attacker.com" -H "Cookie: session=valeur" "https://LAB/accountDetails"                              | curl -H "Origin: http://attacker.com" -H "Cookie: session=valeur" -i "https://LAB/accountDetails"                          | Access-Control-Allow-Credentials: true avec origine tierce          | Envoyez une requête GET avec Origin et un cookie de session. Vérifiez si la réponse contient Access-Control-Allow-Credentials: true pour une origine tierce. | https://portswigger.net/web-security/cors/lab-credentials-allowed                     |
| CORS permissif sur préflight                | préflight POST origine tierce    | curl -X OPTIONS -H "Origin: http://attacker.com" -H "Access-Control-Request-Method: POST" "https://LAB/api/data"            | curl -X OPTIONS -H "Origin: http://attacker.com" -H "Access-Control-Request-Method: POST" -i "https://LAB/api/data"        | Access-Control-Allow-Methods et Access-Control-Allow-Origin larges  | Envoyez une requête OPTIONS avec Origin et Access-Control-Request-Method. Vérifiez si la méthode POST et l’origine tierce sont autorisées dans la réponse. | https://portswigger.net/web-security/cors/lab-preflight-attack                        |
| CORS permissif sur headers personnalisés    | header personnalisé              | curl -X OPTIONS -H "Origin: http://attacker.com" -H "Access-Control-Request-Method: GET" -H "Access-Control-Request-Headers: X-Test-Header" "https://LAB/api/data" | curl -X OPTIONS -H "Origin: http://attacker.com" -H "Access-Control-Request-Method: GET" -H "Access-Control-Request-Headers: X-Test-Header" -i "https://LAB/api/data" | Access-Control-Allow-Headers autorise le header personnalisé         | Envoyez une requête OPTIONS avec Origin et Access-Control-Request-Headers pour un header personnalisé. Vérifiez si ce header est autorisé pour une origine tierce. | https://portswigger.net/web-security/cors/lab-authorizing-unsafe-request-headers      |
| CORS restrictif (contrôle)                  | origine autorisée                | curl -H "Origin: https://trusted.com" "https://LAB/accountDetails"                                                          | curl -H "Origin: https://trusted.com" -i "https://LAB/accountDetails"                                                      | Access-Control-Allow-Origin correspond à l’origine attendue         | Envoyez une requête avec une origine autorisée. Vérifiez que l’en-tête Access-Control-Allow-Origin correspond bien à cette origine et pas à d’autres. | https://portswigger.net/web-security/cors/                                            |

---
