# CRSF

Voici un tableau synthétique pour l’analyse et la découverte des failles CSRF sur les labs PortSwigger, avec des charges utiles **neutralisées** (pas de code HTML ou de balise dans les cellules), garantissant l’alignement parfait des colonnes et des phrases correctes en français :

| Type / Lab                                 | Payload d’attaque neutre           | Commande d’attaque (curl)                                    | Commande(s) d’analyse curl                                    | Élément d’analyse (raison préalable)                      | Méthodologie détaillée de découverte                                                                                   | URL                                                                                   |
|---------------------------------------------|------------------------------------|--------------------------------------------------------------|---------------------------------------------------------------|-----------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|
| CSRF sans protection                       | changement d’email direct          | curl -d "email=nouveau@mail.com" https://LAB/my-account/change-email | curl -d "email=nouveau@mail.com" https://LAB/my-account/change-email | Changement d’email accepté sans vérification              | Envoyez une requête de modification d’email sans aucun jeton CSRF. Vérifiez que le changement est accepté sans protection. | https://portswigger.net/web-security/csrf/lab-no-defenses                            |
| CSRF avec jeton non lié à la session        | jeton CSRF d’un autre utilisateur  | curl -d "email=autre@mail.com&csrf=jeton" https://LAB/my-account/change-email | curl -d "email=autre@mail.com&csrf=jeton_autre_user" https://LAB/my-account/change-email | Jeton CSRF accepté même s’il ne correspond pas à la session | Testez un jeton CSRF obtenu sur un autre compte. Si la requête est acceptée, le jeton n’est pas lié à la session utilisateur. | https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-not-tied-to-user-session |
| CSRF avec jeton lié à un cookie non session | jeton CSRF dans cookie modifiable  | curl -d "email=modif@mail.com&csrf=jeton" --cookie "csrfKey=valeur" https://LAB/my-account/change-email | curl -d "email=modif@mail.com&csrf=jeton_autre&csrfKey=valeur_autre" --cookie "csrfKey=valeur_autre" https://LAB/my-account/change-email | Jeton CSRF validé via un cookie indépendant de la session | Modifiez le cookie contenant le jeton CSRF en utilisant une valeur d’un autre utilisateur. Si la modification est acceptée, le jeton n’est pas lié à la session. | https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-tied-to-non-session-cookie |
| CSRF avec double soumission du jeton        | même valeur dans cookie et paramètre | curl -d "email=double@mail.com&csrf=valeur" --cookie "csrf=valeur" https://LAB/my-account/change-email | curl -d "email=double@mail.com&csrf=faux" --cookie "csrf=faux" https://LAB/my-account/change-email | Jeton CSRF validé par comparaison cookie/paramètre        | Placez la même valeur de jeton dans le cookie et dans le paramètre POST. Si la requête est acceptée, l’application utilise la technique de double soumission. | https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-duplicated-in-cookie |
| CSRF protection dépendante de la méthode    | requête GET sans jeton             | curl "https://LAB/my-account/change-email?email=get@mail.com" | curl "https://LAB/my-account/change-email?email=get@mail.com" | Jeton CSRF non vérifié pour la méthode GET                | Essayez de changer l’email avec une requête GET sans jeton CSRF. Si la modification passe, la protection ne s’applique qu’aux POST. | https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-validation-depends-on-request-method |

---
