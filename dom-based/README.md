# DOM-based

Voici le tableau DOM-based XSS PortSwigger avec **des commandes curl différenciées pour chaque ligne** : la commande d’attaque et la commande d’analyse sont adaptées à la nature de chaque vecteur, et chaque description reste claire et en bon français.

| Type / Lab                                 | Payload d’attaque neutre      | Commande d’attaque (curl)                                                                                         | Commande(s) d’analyse curl                                                                                           | Élément d’analyse (raison préalable)                        | Méthodologie détaillée de découverte                                                                                   | URL                                                                                   |
|---------------------------------------------|-------------------------------|-------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|
| DOM XSS via location.search (reflected)     | testdomxss                    | curl -A "Mozilla/5.0" "https://LAB/?search=testdomxss"                                                            | curl -A "Mozilla/5.0" -i "https://LAB/?search=testdomxss"                                                            | Affichage du paramètre dans la page via JavaScript           | Injectez une valeur neutre dans le paramètre de recherche. Ouvrez la page dans un navigateur. Vérifiez si la valeur apparaît dans le DOM ou dans un script côté client. | https://portswigger.net/web-security/cross-site-scripting/dom-based                   |
| DOM XSS via location.hash                   | testhashxss                   | curl -A "Mozilla/5.0" "https://LAB/#testhashxss"                                                                  | curl -A "Mozilla/5.0" -i "https://LAB/#testhashxss"                                                                  | Utilisation de la valeur du hash dans le DOM                | Ajoutez une valeur neutre après le dièse dans l’URL. Ouvrez la page dans un navigateur. Vérifiez si cette valeur est utilisée dans le DOM ou dans un attribut HTML. | https://portswigger.net/web-security/cross-site-scripting/dom-based                   |
| DOM XSS via document.cookie                 | testcookiexss                 | curl -A "Mozilla/5.0" --cookie "session=testcookiexss" "https://LAB/"                                             | curl -A "Mozilla/5.0" --cookie "session=testcookiexss" -i "https://LAB/"                                             | Lecture et utilisation de la valeur d’un cookie dans le DOM  | Ajoutez un cookie contrôlé dans la requête. Ouvrez la page dans un navigateur. Vérifiez si la valeur du cookie est utilisée dans le DOM ou dans un script côté client. | https://portswigger.net/web-security/dom-based/cookie-manipulation/lab-dom-cookie-manipulation |
| DOM XSS via location.href ou pathname       | testhrefxss                   | curl -A "Mozilla/5.0" "https://LAB/page/testhrefxss"                                                              | curl -A "Mozilla/5.0" -i "https://LAB/page/testhrefxss"                                                              | Utilisation de la valeur du chemin ou de l’URL dans le DOM   | Modifiez le chemin ou le paramètre de l’URL. Ouvrez la page dans un navigateur. Vérifiez si la valeur apparaît dans le DOM ou dans un attribut HTML sans filtre. | https://portswigger.net/web-security/cross-site-scripting/dom-based                   |
| DOM XSS via paramètre d’URL dans attribut   | testattrxss                   | curl -A "Mozilla/5.0" "https://LAB/?img=testattrxss"                                                              | curl -A "Mozilla/5.0" -i "https://LAB/?img=testattrxss"                                                              | Injection de la valeur dans un attribut HTML via JavaScript  | Injectez une valeur neutre dans un paramètre utilisé pour un attribut HTML (par exemple src ou href). Vérifiez si la valeur est insérée dans l’attribut sans filtre côté client. | https://portswigger.net/web-security/cross-site-scripting/dom-based                   |
| DOM XSS via stockage local                  | testlocalstorage               | curl -A "Mozilla/5.0" "https://LAB/?data=testlocalstorage"                                                         | curl -A "Mozilla/5.0" -i "https://LAB/?data=testlocalstorage"                                                         | Utilisation de la valeur stockée dans le localStorage       | Injectez une valeur neutre dans un paramètre qui est stocké côté client. Ouvrez la page dans un navigateur. Vérifiez si la valeur du stockage local est réutilisée dans le DOM sans filtre. | https://portswigger.net/web-security/cross-site-scripting/dom-based                   |
| DOM XSS via WebSocket URL                   | testwsxss                      | curl -A "Mozilla/5.0" "https://LAB/?ws=testwsxss"                                                                 | curl -A "Mozilla/5.0" -i "https://LAB/?ws=testwsxss"                                                                 | Utilisation de la valeur dans l’URL WebSocket               | Injectez une valeur neutre dans un paramètre utilisé comme URL de WebSocket. Vérifiez si cette valeur est utilisée sans validation dans le code JavaScript côté client. | https://portswigger.net/web-security/dom-based                                               |
| DOM XSS via postMessage                     | testmsgxss                     | curl -A "Mozilla/5.0" "https://LAB/?msg=testmsgxss"                                                               | curl -A "Mozilla/5.0" -i "https://LAB/?msg=testmsgxss"                                                               | Utilisation de la valeur dans un message postMessage        | Injectez une valeur neutre dans un paramètre utilisé dans un postMessage. Vérifiez si la valeur est traitée sans validation dans le code JavaScript côté client. | https://portswigger.net/web-security/dom-based                                               |

---
