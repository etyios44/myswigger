# Websocket

Voici un tableau synthétique pour l’analyse des failles WebSocket, **avec des exemples de commandes complètes et différenciées pour l’attaque et pour l’analyse**, en ligne de commande (principalement avec `wscat` et `websocat`), selon chaque cas. Les commandes sont adaptées pour chaque scénario et permettent de comparer précisément les comportements[1][2].

| Type / Lab                                         | Payload d’attaque neutre (exemple)             | Commande d’attaque (complète)                                                                                                   | Commande(s) d’analyse (complète)                                                                                  | Élément d’analyse (raison préalable)                        | Méthodologie détaillée de découverte                                                                                   |
|----------------------------------------------------|------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|
| Manipulation de message WebSocket (XSS, logique)   | {"message":"<img src=1 onerror='alert(1)'>"}   | `wscat -c wss://LAB/ws/chat`<br>Puis tapez :<br>`{"message":"<img src=1 onerror='alert(1)'>"}`                                 | `wscat -c wss://LAB/ws/chat`<br>Puis tapez :<br>`{"message":"test"}`                                              | Réponse ou comportement côté client ou serveur              | Envoyez un message modifié (payload XSS ou logique), puis un message neutre, et comparez la réponse ou le comportement de l’application[1][2]. |
| Manipulation du handshake (bypass IP, headers)     | X-Forwarded-For: 1.1.1.1                       | `websocat -H "X-Forwarded-For: 1.1.1.1" wss://LAB/ws/chat`                                                                   | `websocat wss://LAB/ws/chat`                                                                                      | Différence de comportement lors de la connexion             | Ajoutez un header personnalisé lors du handshake pour tenter de contourner des restrictions IP, puis comparez avec une connexion classique[1][2]. |
| Cross-site WebSocket Hijacking (CSWH)              | Origin: https://evil.com                       | `websocat -H "Origin: https://evil.com" wss://LAB/ws/chat`                                                                   | `websocat -H "Origin: https://LAB" wss://LAB/ws/chat`                                                             | Acceptation de la connexion sans contrôle d’origine         | Simulez une connexion WebSocket avec un header Origin usurpé, puis avec l’Origin légitime, et comparez l’acceptation de la connexion[1][2]. |
| Absence de vérification Origin/CSRF                | Origin: https://attacker.com                   | `websocat -H "Origin: https://attacker.com" wss://LAB/ws/chat`                                                               | `websocat -H "Origin: https://LAB" wss://LAB/ws/chat`                                                             | Acceptation de la connexion sans contrôle d’origine         | Ouvrez une WebSocket avec un header Origin usurpé, puis avec l’Origin légitime, et comparez la réponse ou le comportement du serveur[1][2]. |
| Problème de gestion des droits (data leak)         | {"action":"get","user":"victime"}              | `wscat -c wss://LAB/ws/chat`<br>Puis tapez :<br>`{"action":"get","user":"victime"}`                                          | `wscat -c wss://LAB/ws/chat`<br>Puis tapez :<br>`{"action":"get","user":"vous"}`                                 | Réception de données d’autres utilisateurs                  | Envoyez une requête visant à accéder aux données d’un autre utilisateur, puis une requête normale, et comparez les réponses reçues[1][2]. |

---
