# XXE

Voici un tableau XXE PortSwigger avec **commandes curl différenciées pour l’attaque et l’analyse** sur chaque ligne, des charges utiles neutres (fichiers à préparer), et des explications claires en français :

| Type / Lab                                    | Payload d’attaque neutre (exemple)         | Commande d’attaque (curl)                                                                                   | Commande(s) d’analyse curl                                                                                 | Élément d’analyse (raison préalable)                      | Méthodologie détaillée de découverte                                                                                   | URL                                                                                   |
|-----------------------------------------------|--------------------------------------------|-------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|
| XXE classique (lecture de fichier)            | entité externe lisant un fichier           | curl -X POST -H "Content-Type: application/xml" --data-binary @xxe-payload.xml https://LAB/parse-xml        | curl -X POST -H "Content-Type: application/xml" --data-binary @xxe-analyse.xml https://LAB/parse-xml       | Présence du contenu du fichier dans la réponse             | Envoyez un XML contenant une entité externe qui lit un fichier système. Changez la cible du fichier dans le XML d’analyse pour comparer les réponses. | https://portswigger.net/web-security/xxe/lab-exploiting-xxe-to-retrieve-files         |
| XXE via upload de fichier XML (SVG, etc.)     | entité externe dans un fichier SVG         | curl -F "avatar=@xxe-payload.svg" https://LAB/upload-avatar                                                 | curl -F "avatar=@xxe-analyse.svg" https://LAB/upload-avatar                                                | Affichage du contenu du fichier dans la page ou l’image    | Téléversez un SVG contenant une entité externe lisant un fichier sensible. Faites un upload neutre pour comparer l’affichage ou la réponse. | https://portswigger.net/web-security/xxe/lab-xxe-via-file-upload                     |
| XXE pour SSRF (requête interne)               | entité externe vers une URL interne        | curl -X POST -H "Content-Type: application/xml" --data-binary @xxe-ssrf.xml https://LAB/product/stock       | curl -X POST -H "Content-Type: application/xml" --data-binary @xxe-ssrf-analyse.xml https://LAB/product/stock | Réponse contenant des infos internes ou d’API cloud        | Utilisez une entité externe pointant vers une URL interne (ex : metadata cloud). Testez une URL neutre pour comparer la différence de réponse. | https://portswigger.net/web-security/xxe/lab-exploiting-xxe-to-perform-ssrf          |
| XXE aveugle (blind, interaction externe)      | entité externe vers serveur contrôlé       | curl -X POST -H "Content-Type: application/xml" --data-binary @xxe-blind.xml https://LAB/parse-xml          | Surveillez les requêtes reçues sur votre serveur externe (ex : tcpdump, Burp Collaborator, logs web)        | Détection d’une interaction réseau sortante                | Définissez une entité externe vers un serveur que vous contrôlez. Surveillez les accès sur ce serveur pour confirmer l’exploitation. | https://portswigger.net/web-security/xxe/lab-blind-xxe-with-out-of-band-interaction  |
| XXE via XInclude                              | balise XInclude pour inclure un fichier    | curl -X POST -H "Content-Type: application/xml" --data-binary @xxe-xinclude.xml https://LAB/parse-xml       | curl -X POST -H "Content-Type: application/xml" --data-binary @xxe-xinclude-analyse.xml https://LAB/parse-xml | Présence du contenu du fichier dans la réponse             | Utilisez la balise XInclude dans le XML pour inclure un fichier système. Faites une requête neutre pour comparer la différence de réponse. | https://portswigger.net/web-security/xxe/lab-xinclude-attack                        |
| XXE DoS (Billion Laughs)                      | entités récursives pour déni de service    | curl -X POST -H "Content-Type: application/xml" --data-binary @xxe-dos.xml https://LAB/parse-xml            | curl -X POST -H "Content-Type: application/xml" --data-binary @xxe-dos-analyse.xml https://LAB/parse-xml    | Blocage ou ralentissement du serveur, erreur parsing XML   | Envoyez un XML contenant des entités récursives (Billion Laughs). Faites une requête neutre pour comparer le comportement du serveur. | https://www.reseaucerta.org/sites/default/files/owasp-activite5-v1.0.pdf             |

---
